name: 'LTS Library Test'
description: 'Checks the compatibility of the libraries in the LTS BOM'
inputs:
  repository:
    description: 'The repository to test in this run. Use matrix to specify the values'
    required: true
runs:
  using: "composite"
  steps:
    - run: >
        B=$(dirname $(which javac))
        echo $B
        J=${B}/..
        EXT_DIR=${J}/jre/lib/ext
        echo ${EXT_DIR}
        ls ${EXT_DIR}
        echo "hello java ext directory" >> ${EXT_DIR}/hello.txt
      shell: bash
    - run: >
        mvn -B -e -ntp -pl dependencies,lts-test test \
          -Dtest=com.google.cloud.tools.opensource.lts.LtsBomCompatibilityTest \
          -Dlts.test.repository=${{ inputs.repository }} \
          -DfailIfNoTests=false
      shell: bash
